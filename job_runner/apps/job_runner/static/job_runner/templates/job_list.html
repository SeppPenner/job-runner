<section class="jobs">
    <div class="row filters">
        <div class="span3">
            <h5>Template</h5>
            <select ng-model="global_state.job_filter.job_template" ng-options="job_template.resource_uri as job_template.title for job_template in job_templates">
            </select>
        </div>
        <div class="span3">
            <h5>Reschedule interval type</h5>
            <select ng-model="global_state.job_filter.reschedule_interval_type" ng-options="item[0] as item[1] for item in [['', ''], ['MINUTE', 'minute'], ['HOUR', 'hour'], ['DAY', 'day'], ['MONTH', 'month']]"></select>
        </div>
        <div class="span3">
            <h5>Search</h5>
            <input ng-model="global_state.job_filter.title" type="text" class="input-large" />
        </div>
    </div>
    <div class="row">
        <div class="span6 jobs">

            <div ng-repeat="job in jobs | orderBy:title | filter:global_state.job_filter" class="span2">
                <div class="job">
                    <h5><a href="/project/{{ global_state.project.id }}/jobs/{{ job.id }}/" class="details">{{ job.title }}</a></h5>
                    <ul>
                        <li>
                            <i class="icon-hdd"></i> {{ job.get_job_template().get_worker().title }}
                        </li>
                    </ul>
                </div>
            </div>

        </div>
        <div class="span6 job-details" ng-switch on="job != null">
            <div ng-switch-when="true">
                <div class="tabbable">
                    <ul class="nav nav-tabs">
                        <li class="active">
                            <a href="#tab1" data-toggle="tab" target="_self">Job details</a>
                        </li>
                        <li>
                            <a href="#tab2" data-toggle="tab" target="_self">Last 100 completed runs</a>
                        </li>
                    </ul>
                    <div class="tab-content">
                        <div class="tab-pane active" id="tab1">
                            <h5>Title</h5>
                            <p>{{ job.title }}</p>

                            <h5>Description</h5>
                            <div ng-switch on="job.description != ''">
                                <p ng-switch-when="true">{{ job.description }}</p>
                                <p ng-switch-default>No description given.</p>
                            </div>

                            <h5>Re-schedule interval</h5>
                            <div ng-switch on="job.reschedule_interval != '' && job.reschedule_interval_type != ''">
                                <p ng-switch-when="true">Every {{ job.reschedule_interval }} {{ job.reschedule_interval_type |lowercase }}(s)</p>
                                <p ng-switch-default>No interval specified.</p>
                            </div>

                            <h5>Parent</h5>
                            <div ng-switch on="job.parent != null">
                                <p ng-switch-when="true"><a href="../{{ job.get_parent().id }}/">{{ job.get_parent().title }}</a></p>
                                <p ng-switch-default>This job does not have a parent.</p>
                            </div>

                            <h5>Children</h5>
                            <div ng-switch on="job.children.length != 0">
                                <p ng-switch-when="true">
                                    <ul>
                                        <li ng-repeat="child in job.get_children()"><a href="../{{ child.id }}/">{{ child.title }}</a></li>
                                    </ul>
                                </p>
                                <p ng-switch-default>This job does not have any children.</p>
                            </div>

                            <h5>Command</h5>
                            <p>
                                <pre>{{ job.script_content }}</pre>
                            </p>
                        </div>
                        <div class="tab-pane" id="tab2">Tab 2</div>
                    </div>
                </div>
            </div>
            <div class="hero-unit" ng-switch-default>
                <p>Click on a job to see its details and run history...</p>
            </div>
        </div>
    </div>
</section>